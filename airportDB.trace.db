2025-06-04 13:23:53.527451+07:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Столбец "DEPARTMENTLEADER" не найден
Column "DEPARTMENTLEADER" not found; SQL statement:
SELECT DepartmentLeader FROM Departments LIMIT 0 [42122-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1170)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:489)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at org.example.MainWindow.FrameWork.createTables(FrameWork.java:272)
	at org.example.MainWindow.FrameWork.<init>(FrameWork.java:68)
	at org.example.Main.main(Main.java:11)
2025-06-04 13:26:19.686534+07:00 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Синтаксическая ошибка в выражении SQL "SELECT \000a    f.FlightID,\000a    pt.ModelName AS PlaneModel,\000a    loc_from.LocationName AS DepartureLocation,\000a    loc_to.LocationName AS ArrivalLocation,\000a    DATEDIFF(MINUTE, f.FromTime, f.ToTime) AS FlightDurationMinutes,\000a    f.FromTime AS DepartureTime,\000a    f.ToTime AS ArrivalTime,\000a    COUNT(t.TicketID) AS TicketsSold,\000a    AVG(t.TicketCost) AS AverageTicketPrice,\000a    (SELECT AVG(COUNT(t2.TicketID))\000a     FROM Flights f2\000a     JOIN Tickets t2 ON f2.FlightID = t2.FlightID AND t2.TicketStatus = 'Sold'\000a     WHERE f2.PlaneID IN (SELECT PlanesID FROM Planes WHERE PlaneTypeID = pl.PlaneTypeID)\000a       AND (f2.FromLocation = f.FromLocation OR [*][same_route_only] = 0)\000a       AND (f2.ToLocation = f.ToLocation OR [same_route_only] = 0)\000a     GROUP BY f2.FlightID) AS AvgTicketsForSimilarFlights\000aFROM \000a    Flights f\000aJOIN \000a    Planes pl ON f.PlaneID = pl.PlanesID\000aJOIN \000a    PlaneTypeCharacteristics pt ON pl.PlaneTypeID = pt.TypeID\000aJOIN \000a    Locations loc_from ON f.FromLocation = loc_from.LocationID\000aJOIN \000a    Locations loc_to ON f.ToLocation = loc_to.LocationID\000aLEFT JOIN \000a    Tickets t ON f.FlightID = t.FlightID AND t.TicketStatus = 'Sold'\000aWHERE \000a    (pt.ModelName = [plane_model] OR [plane_model] IS NULL)\000a    \000a    AND (loc_from.LocationName = [departure_location] OR [departure_location] IS NULL)\000a    \000a    AND (loc_to.LocationName = [arrival_location] OR [arrival_location] IS NULL)\000a    \000a    AND (DATEDIFF(MINUTE, f.FromTime, f.ToTime) BETWEEN [min_duration] AND [max_duration]\000a        OR ([min_duration] IS NULL AND [max_duration] IS NULL))\000a    \000a    AND (t.TicketCost BETWEEN [min_price] AND [max_price]\000a        OR ([min_price] IS NULL AND [max_price] IS NULL))\000a    \000a    AND (CONVERT(TIME, f.FromTime) BETWEEN [start_time] AND [end_time]\000a        OR ([start_time] IS NULL AND [end_time] IS NULL))\000aGROUP BY \000a    f.FlightID,\000a    pt.ModelName,\000a    loc_from.LocationName,\000a    loc_to.LocationName,\000a    f.FromTime,\000a    f.ToTime,\000a    pl.PlaneTypeID,\000a    f.FromLocation,\000a    f.ToLocation\000aORDER BY \000a    f.FromTime;"; ожидалось "INTERSECTS (, NOT, EXISTS, UNIQUE, INTERSECTS"
Syntax error in SQL statement "SELECT \000a    f.FlightID,\000a    pt.ModelName AS PlaneModel,\000a    loc_from.LocationName AS DepartureLocation,\000a    loc_to.LocationName AS ArrivalLocation,\000a    DATEDIFF(MINUTE, f.FromTime, f.ToTime) AS FlightDurationMinutes,\000a    f.FromTime AS DepartureTime,\000a    f.ToTime AS ArrivalTime,\000a    COUNT(t.TicketID) AS TicketsSold,\000a    AVG(t.TicketCost) AS AverageTicketPrice,\000a    (SELECT AVG(COUNT(t2.TicketID))\000a     FROM Flights f2\000a     JOIN Tickets t2 ON f2.FlightID = t2.FlightID AND t2.TicketStatus = 'Sold'\000a     WHERE f2.PlaneID IN (SELECT PlanesID FROM Planes WHERE PlaneTypeID = pl.PlaneTypeID)\000a       AND (f2.FromLocation = f.FromLocation OR [*][same_route_only] = 0)\000a       AND (f2.ToLocation = f.ToLocation OR [same_route_only] = 0)\000a     GROUP BY f2.FlightID) AS AvgTicketsForSimilarFlights\000aFROM \000a    Flights f\000aJOIN \000a    Planes pl ON f.PlaneID = pl.PlanesID\000aJOIN \000a    PlaneTypeCharacteristics pt ON pl.PlaneTypeID = pt.TypeID\000aJOIN \000a    Locations loc_from ON f.FromLocation = loc_from.LocationID\000aJOIN \000a    Locations loc_to ON f.ToLocation = loc_to.LocationID\000aLEFT JOIN \000a    Tickets t ON f.FlightID = t.FlightID AND t.TicketStatus = 'Sold'\000aWHERE \000a    (pt.ModelName = [plane_model] OR [plane_model] IS NULL)\000a    \000a    AND (loc_from.LocationName = [departure_location] OR [departure_location] IS NULL)\000a    \000a    AND (loc_to.LocationName = [arrival_location] OR [arrival_location] IS NULL)\000a    \000a    AND (DATEDIFF(MINUTE, f.FromTime, f.ToTime) BETWEEN [min_duration] AND [max_duration]\000a        OR ([min_duration] IS NULL AND [max_duration] IS NULL))\000a    \000a    AND (t.TicketCost BETWEEN [min_price] AND [max_price]\000a        OR ([min_price] IS NULL AND [max_price] IS NULL))\000a    \000a    AND (CONVERT(TIME, f.FromTime) BETWEEN [start_time] AND [end_time]\000a        OR ([start_time] IS NULL AND [end_time] IS NULL))\000aGROUP BY \000a    f.FlightID,\000a    pt.ModelName,\000a    loc_from.LocationName,\000a    loc_to.LocationName,\000a    f.FromTime,\000a    f.ToTime,\000a    pl.PlaneTypeID,\000a    f.FromLocation,\000a    f.ToLocation\000aORDER BY \000a    f.FromTime;"; expected "INTERSECTS (, NOT, EXISTS, UNIQUE, INTERSECTS"; SQL statement:
SELECT 
    f.FlightID,
    pt.ModelName AS PlaneModel,
    loc_from.LocationName AS DepartureLocation,
    loc_to.LocationName AS ArrivalLocation,
    DATEDIFF(MINUTE, f.FromTime, f.ToTime) AS FlightDurationMinutes,
    f.FromTime AS DepartureTime,
    f.ToTime AS ArrivalTime,
    COUNT(t.TicketID) AS TicketsSold,
    AVG(t.TicketCost) AS AverageTicketPrice,
    (SELECT AVG(COUNT(t2.TicketID))
     FROM Flights f2
     JOIN Tickets t2 ON f2.FlightID = t2.FlightID AND t2.TicketStatus = 'Sold'
     WHERE f2.PlaneID IN (SELECT PlanesID FROM Planes WHERE PlaneTypeID = pl.PlaneTypeID)
       AND (f2.FromLocation = f.FromLocation OR [same_route_only] = 0)
       AND (f2.ToLocation = f.ToLocation OR [same_route_only] = 0)
     GROUP BY f2.FlightID) AS AvgTicketsForSimilarFlights
FROM 
    Flights f
JOIN 
    Planes pl ON f.PlaneID = pl.PlanesID
JOIN 
    PlaneTypeCharacteristics pt ON pl.PlaneTypeID = pt.TypeID
JOIN 
    Locations loc_from ON f.FromLocation = loc_from.LocationID
JOIN 
    Locations loc_to ON f.ToLocation = loc_to.LocationID
LEFT JOIN 
    Tickets t ON f.FlightID = t.FlightID AND t.TicketStatus = 'Sold'
WHERE 
    (pt.ModelName = [plane_model] OR [plane_model] IS NULL)
    
    AND (loc_from.LocationName = [departure_location] OR [departure_location] IS NULL)
    
    AND (loc_to.LocationName = [arrival_location] OR [arrival_location] IS NULL)
    
    AND (DATEDIFF(MINUTE, f.FromTime, f.ToTime) BETWEEN [min_duration] AND [max_duration]
        OR ([min_duration] IS NULL AND [max_duration] IS NULL))
    
    AND (t.TicketCost BETWEEN [min_price] AND [max_price]
        OR ([min_price] IS NULL AND [max_price] IS NULL))
    
    AND (CONVERT(TIME, f.FromTime) BETWEEN [start_time] AND [end_time]
        OR ([start_time] IS NULL AND [end_time] IS NULL))
GROUP BY 
    f.FlightID,
    pt.ModelName,
    loc_from.LocationName,
    loc_to.LocationName,
    f.FromTime,
    f.ToTime,
    pl.PlaneTypeID,
    f.FromLocation,
    f.ToLocation
ORDER BY 
    f.FromTime; [42001-224]
